set scrolloff 10
set sixel true
set mouse true

set hidden true

set shell dash
set ifs "\n"

map w $bash

set previewer ~/.config/lf/previewer

map P &{{
    if [ "$lf_preview" = false ]; then
        lf -remote "send $id :set ratios 1:2:3; set preview true"
    else
        lf -remote "send $id :set ratios 1:2; set preview false"
    fi
}}

cmd open &{{
    ~/.config/lf/opener "$f" &&
    lf -remote "send $id :set ratios 1:2; set preview false"
}}

cmd on-focus-gained :set ratios 1:2:3; set preview true

cmd z &{{
    result="$(zoxide query --exclude "$PWD" "$@" | sed 's/\\/\\\\/g;s/"/\\"/g')" &&
    lf -remote "send $id cd \"$result\""
}}

cmd zi ${{
    result="$(zoxide query -i | sed 's/\\/\\\\/g;s/"/\\"/g')" &&
    lf -remote "send $id cd \"$result\""
}}

cmd on-cd &zoxide add "$PWD"

# Delete built-in mappings
map za
map zh
map zn
map zr
map zs
map zt
# ... and re-bind them
nmap In set info
nmap Is set info size
nmap It set info time
nmap Ia set info size:time
nmap . set hidden!
nmap R set reverse!

# Now use z/Z for zoxide:
map z push :z<space>
map Z zi

map U %du -hs "$PWD"

map Y &{{
    wl-copy "$fx" || exit
    fxs=$(IFS= echo $fx)
    lf -remote "send $id echo \"Copied paths to clipboard: $fxs\""
}}
